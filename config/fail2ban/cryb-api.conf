# Fail2Ban filter for CRYB API attacks

[Definition]
# API authentication failures
failregex = ^.*"ip":"<HOST>".*"status":401.*"message":"Authentication failed".*$
            ^.*"ip":"<HOST>".*"status":403.*"message":"Access denied".*$
            ^.*"ip":"<HOST>".*"status":429.*"message":"Rate limit exceeded".*$
            ^.*"sourceIP":"<HOST>".*"event":"failed_login".*$
            ^.*"clientIP":"<HOST>".*"error":"invalid_credentials".*$

# SQL injection attempts
            ^.*"ip":"<HOST>".*"error":"SQL injection detected".*$
            ^.*"ip":"<HOST>".*"security_violation":"sql_injection".*$

# XSS attempts
            ^.*"ip":"<HOST>".*"error":"XSS attempt detected".*$
            ^.*"ip":"<HOST>".*"security_violation":"xss_attempt".*$

# File upload attacks
            ^.*"ip":"<HOST>".*"error":"Malicious file upload blocked".*$
            ^.*"ip":"<HOST>".*"security_violation":"malicious_upload".*$

# API abuse patterns
            ^.*"ip":"<HOST>".*"error":"Suspicious API usage pattern".*$
            ^.*"ip":"<HOST>".*"violation":"excessive_requests".*$

ignoreregex =

[Init]
# Maximum number of lines to scan
maxlines = 10